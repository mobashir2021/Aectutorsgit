@using AECMIS.MVC.Binders
@using Newtonsoft.Json
@{
    ViewBag.Title = "Session Register Search";
}
@model AECMIS.DAL.Domain.DTO.RegisterSearchResultDto

<h2>Search Registers</h2>
<div id="divMain">
    <div class="container">
        <input type="hidden" data-bind="value:SearchCriteria.PageSize"/>
        <div class="row">
            <div class="col-md-4">
                <div class="form-group">
                    <label for="center">Code</label>
                    <select class="form-control" id="center" name="center" data-bind="options:Centers,optionsCaption:'--select--', optionsText:'Name',optionsValue:'Id',value:SearchCriteria.CentreId"></select>
                </div>
            </div>
            <div class="col-md-4">
                <div class="form-group">
                    <label for="session">Session</label>
                    <select class="form-control" id="session" name="session" data-bind="options:SessionsByCenter,optionsCaption:'--select--', optionsText:'SessionDetails',optionsValue:'SessionId',value:SearchCriteria.SessionId"></select>
                </div>
            </div>
            <div class="col-md-4">
                <div class="form-group">
                    <label for="status">Status</label>
                    <select class="form-control" id="status" name="status" data-bind="options:RegisterStatuses,optionsCaption:'--select--', optionsText:'Text',optionsValue:'Value',value:SearchCriteria.Status"></select>
                </div>
            </div>
        </div>
        <div class="row form-horizontal">
            <div class="col-md-4">
                <div class="form-group">
                    <label class="col-md-3 control-label" for="from">From</label>
                    <div class="col-md-9">
                        <input class="form-control date" type="text" id="from" data-bind="value:SearchCriteria.FromDate"/>
                    </div>
                </div>
            </div>
            <div class="col-md-4">
                <div class="form-group">
                    <label class="col-md-3 control-label" for="to">To</label>
                    <div class="col-md-9">
                        <input class="form-control date" type="text" id="to" data-bind="value:SearchCriteria.ToDate"/>
                    </div>
                </div>
            </div>
            <div class="col-md-4">
                <div class="form-group">
                    <input type="button" class="btn btn-default" value="Add Register" data-bind="click:AddRegister" />
                    <input type="button" class="btn btn-default" value="Search" data-bind="click:SearchRegisters" />
                </div>
            </div>
        </div>
    </div>
    
    <div class="table-responsive">
    <table class="table table-condensed">
        <thead>
            <tr>
                <td>Date</td>
                <td>Session Details</td>
                <td>Status</td>                
            </tr>
        </thead>        
        <tbody data-bind="foreach: Registers">
            <tr>
                <td data-bind="text: Date"></td>
                <td data-bind="text: SessionInfo"></td>
                <td data-bind="text: Status"></td>                
                <td class="buttons">
                    <button class="btn btn-default" data-bind="click: $root.edit" href="#" title="edit"><span class="glyphicon glyphicon-pencil"></span> Edit</button>                     
                </td>
            </tr>
        </tbody>
    </table>
    </div>
    <div class="pagination" data-bind="if:Registers().length > 0" id="pagerContainer">
        @Html.Partial("_pager")
    </div>
</div>

<script src="@Url.Content("~/js/studentRegisterSearchViewModel.js")" type="text/javascript"></script>
<script src="@Url.Content("~/js/pagerViewModel.js")" type="text/javascript"></script>
<script type="text/javascript">
    $(function () {
        var viewModel = new RegisterSearchViewModel((@Html.Raw(Model.SerializeObject())),@Html.Raw(JsonConvert.SerializeObject(ViewData["Sessions"])));
        viewModel.Centers = @Html.Raw(ViewData["Centers"].SerializeObject());
        viewModel.RegisterStatuses = @Html.Raw(ViewData["RegisterStatuses"].SerializeObject());
        ko.applyBindings(viewModel, $("#divMain")[0]);
    });
    
   
</script>
